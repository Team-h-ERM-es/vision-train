# Team hERMes - Efficient Robot Movement

This project utilizes [uv](https://github.com/astral-sh/uv), an extremely fast Python package installer and resolver, for managing Python virtual environments and dependencies.

## Install uv (Recommended Python Environment Manager)

It is recommended to use `uv` for creating the virtual environment and managing packages, as the following setup steps are tailored for it. However, if you are familiar with other Python environment management tools (like the standard `venv` module and `pip`), you can adapt these instructions to your preferred workflow.

If you choose to use `uv` and don't have it installed, you can find installation instructions on the [official `uv` installation guide](https://github.com/astral-sh/uv#installation).


## 1. Create and activate a virtual environment
```bash
uv venv
source .venv/bin/activate
```

## 2. Install PyTorch for your specific hardware
---> IMPORTANT! <---
Install the correct PyTorch version BEFORE installing packages from requirements.txt. The version depends on your GPU (NVIDIA/AMD) or if you are using CPU only.

Go to the [Official PyTorch Website (Get Started Locally)](https://pytorch.org/get-started/locally/) to find the latest, correct installation command for your specific system configuration (OS, Package Manager (pip), Compute Platform (CUDA/ROCm/CPU)).

A. For NVIDIA GPUs, the command will look like this:
```bash
# EXAMPLE ONLY - GET THE CORRECT COMMAND FROM PYTORCH.ORG
pip install torch torchvision torchaudio --extra-index-url https://download.pytorch.org/whl/cu118
```

B. For AMD GPUs, the command will look like this:
```bash
# EXAMPLE ONLY - GET THE CORRECT COMMAND FROM PYTORCH.ORG
pip install torch torchvision torchaudio --extra-index-url https://download.pytorch.org/whl/rocm6.3
```


## 3. Install the required packages
```bash
pip install -r requirements.txt
```



## Project Scripts

This project contains several Python scripts for training and testing YOLOv8 models:

*   `main.py`: 
    *   This is the primary script for training the YOLOv8 instance segmentation model.
    *   It handles GPU detection (NVIDIA CUDA and AMD ROCm/HIP), loads a pre-trained model, and starts the fine-tuning process based on the configuration variables set within the script (e.g., `EPOCHS`, `IMG_SIZE`, `PRETRAINED_MODEL`, `PROJECT_NAME`, `RUN_NAME`).
    *   **Important for AMD GPUs**: This script includes specific environment variable settings (`HSA_OVERRIDE_GFX_VERSION` and `AMD_SERIALIZE_KERNEL`) to aid compatibility and debugging on AMD ROCm platforms. Ensure `HSA_OVERRIDE_GFX_VERSION` is set to match your GPU's architecture (e.g., "12.0.1" for gfx1201) by checking `rocminfo | grep gfx`.

*   `test.py`:
    *   A simple script to load a trained YOLO model and run inference on a webcam feed.
    *   It displays the annotated video stream in real-time.
    *   **Note**: This script may need its model path updated to point to the specific weights generated by `main.py` (e.g., `"pren_robot_segmentation/fine_tune_yolov8s3/weights/best.pt"` or similar, found in `runs/segment/PROJECT_NAME/RUN_NAME/weights/best.pt`). It also does not currently include the AMD-specific environment variables from `main.py`, which might be necessary for it to run correctly on an AMD GPU that requires them.

*   `test-pytorch.py`:
    *   A diagnostic script to verify the PyTorch installation and check for GPU availability (CUDA/ROCm and Apple MPS).
    *   It prints basic information about the PyTorch version, Python version, and detected GPU(s).
    *   This script provides a general check but does not include the AMD-specific environment variables found in `main.py`.
